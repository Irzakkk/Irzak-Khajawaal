{%- comment -%}
  sections/gift-guide-banner.liquid
  - Top header (logo + tagline + choose button) with mobile hamburger menu
  - Then the gift-guide hero banner and bottom strip
  - Mobile-specific heading/subtext + CSS/JS fixes per user request
{%- endcomment -%}

{% liquid
  assign sec = section
%}

<section id="gift-guide-{{ section.id }}" class="gift-guide-section">
  {%- style -%}
    /* Root variables */
    #gift-guide-{{ section.id }} {
      --gg-max-w: 1280px;
      --gg-yellow: {{ section.settings.choose_btn_bg | default: '#FFE34D' }};
      --gg-bg: {{ section.settings.section_bg | default: '#ffffff' }};
      --gg-text: {{ section.settings.text_color | default: '#111111' }};
      width: 100%;
      background: var(--gg-bg);
      color: var(--gg-text);
      box-sizing: border-box;
    }

    /* ---------- HEADER (top) ---------- */
    #gift-guide-{{ section.id }} .hb {
      border-bottom: 1px solid rgba(0,0,0,0.06);
      background: {{ section.settings.header_bg | default: '#ffffff' }};
      position: relative;
      z-index: 1200;
    }
    #gift-guide-{{ section.id }} .hb-inner {
      max-width: var(--gg-max-w);
      margin: 0 auto;
      padding: 10px 16px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      height: 64px;
      box-sizing: border-box;
    }

    /* Hamburger - mobile */
    #gift-guide-{{ section.id }} .hb-hamburger {
      display: none;
      background: transparent;
      border: 0;
      font-size: 22px;
      line-height: 1;
      cursor: pointer;
      padding: 8px;
      width: 44px;
      height: 44px;
    }

    /* Logo block */
    #gift-guide-{{ section.id }} .hb-logo-wrap { display:flex; flex-direction:column; align-items:center; justify-content:center; flex:1 1 auto; }
    #gift-guide-{{ section.id }} .hb-logo { margin:0; font-size:22px; font-weight:700; letter-spacing:.06em; text-align:center; }
    #gift-guide-{{ section.id }} .hb-tagline { font-size:13px; margin-top:4px; text-align:center; color:var(--gg-text); opacity:.95; }

    /* Right choose button for desktop */
    #gift-guide-{{ section.id }} .hb-right { display:flex; align-items:center; justify-content:flex-end; min-width:170px; }
    #gift-guide-{{ section.id }} .hb-choose {
      display:inline-flex; align-items:center; gap:10px; padding:10px 20px; border-radius:6px;
      background: var(--gg-yellow); color:#000; font-weight:700; text-decoration:none;
      border:1px solid rgba(0,0,0,.08); transition: background .18s ease, color .18s ease, transform .12s ease, box-shadow .12s ease;
    }
    #gift-guide-{{ section.id }} .hb-choose:hover { background:#000; color:var(--gg-yellow); transform: translateY(-2px); box-shadow:0 8px 20px rgba(0,0,0,.14); }

    /* Mobile slide-down menu */
    #gift-guide-{{ section.id }} .hb-mobile-menu {
      display:none;
      position:absolute; left:0; right:0; top:64px;
      background: {{ section.settings.header_bg | default: '#fff' }};
      padding:18px 16px; box-shadow:0 10px 30px rgba(0,0,0,.06);
      z-index:1190;
    }
    #gift-guide-{{ section.id }} .hb-mobile-menu.open { display:block; }
    #gift-guide-{{ section.id }} .hb-mobile-menu .hb-tagline { margin-bottom:14px; text-align:left; }

    /* ---------- Announcement bar (if used) ---------- */
    #gift-guide-{{ section.id }} .gg-announcement { width:100%; background: {{ section.settings.announcement_bg | default: '#efefef' }}; border-bottom:1px solid rgba(0,0,0,.04); }
    #gift-guide-{{ section.id }} .gg-announcement__inner { max-width:var(--gg-max-w); margin:0 auto; padding:10px 16px; display:grid; grid-template-columns:1fr auto; align-items:center; gap:12px; font-size:14px; }
    #gift-guide-{{ section.id }} .gg-announcement__text { text-align:center; opacity:.9; }

    /* ---------- HERO (desktop + mobile variants) ---------- */
    #gift-guide-{{ section.id }} .gg-wrap { position: relative; max-width: var(--gg-max-w); margin: 0 auto; }
    #gift-guide-{{ section.id }} .gg-content { position: relative; z-index: 2; padding: 24px 16px 0; max-width: 720px; }
    /* desktop heading */
    #gift-guide-{{ section.id }} .gg-heading { font-size: clamp(36px, 5.2vw, 84px); line-height: .95; font-weight:700; color:var(--gg-text); margin:0 0 12px; }
    /* mobile-specific heading (hidden on desktop) */
    #gift-guide-{{ section.id }} .gg-heading--mobile { display:none; font-size: 28px; line-height:1.05; font-weight:700; margin:0 0 8px; }

    #gift-guide-{{ section.id }} .gg-subtext { font-size: clamp(14px, 1.5vw, 18px); line-height:1.6; max-width:620px; color:var(--gg-text); }
    /* mobile-specific subtext (hidden on desktop) */
    #gift-guide-{{ section.id }} .gg-subtext--mobile { display:none; font-size:15px; margin-top:6px; }

    /* Desktop CTA */
    #gift-guide-{{ section.id }} .gg-cta { margin-top:22px; display:inline-flex; align-items:center; gap:14px; background:#000; color:#fff; text-decoration:none; padding:16px 34px; border-radius:8px; border:2px solid #000; font-weight:700; transition: transform .2s ease, box-shadow .2s ease; }
    #gift-guide-{{ section.id }} .gg-cta:hover { transform: translateY(-2px); box-shadow:0 8px 24px rgba(0,0,0,.25); }
    /* Mobile CTA inside banner: wider, no hover transform/box-shadow */
    #gift-guide-{{ section.id }} .gg-cta--mobile { position:absolute; left:50%; bottom:18px; transform:translateX(-50%); display:none; padding:14px 44px; border-radius:8px; font-weight:700; }
    #gift-guide-{{ section.id }} .gg-cta--mobile:hover { transform:none; box-shadow:none; } /* remove hover animation on mobile */

    /* HERO image */
    #gift-guide-{{ section.id }} .gg-hero { position:relative; margin:0 auto; padding:0 16px 0; }
    #gift-guide-{{ section.id }} .gg-hero__media { position:relative; width:100%; height:560px; overflow:hidden; }
    #gift-guide-{{ section.id }} .gg-hero__media img { width:100%; height:100%; object-fit:cover; object-position:center; }

    /* Bottom strip */
    #gift-guide-{{ section.id }} .gg-strip { width:100%; border-top:1px solid #111; border-bottom:1px solid #111; background:#f7f7f7; }
    #gift-guide-{{ section.id }} .gg-strip__inner { max-width:var(--gg-max-w); margin:0 auto; padding:10px 16px; text-align:center; font-size:12px; letter-spacing:.08em; font-weight:600; }

    /* Desktop layout: header desktop + overlay content bottom-left */
    @media (min-width: 990px) {
      #gift-guide-{{ section.id }} .hb-hamburger { display:none; }
      #gift-guide-{{ section.id }} .hb-right { display:flex; }
      #gift-guide-{{ section.id }} .hb-mobile-menu { display:none !important; }

      #gift-guide-{{ section.id }} .gg-wrap { padding: 24px 0 28px; }
      #gift-guide-{{ section.id }} .gg-content { position:absolute; left:16px; bottom:40px; }
      #gift-guide-{{ section.id }} .gg-hero__media { height:680px; }

      /* desktop: show desktop heading/subtext, hide mobile variants */
      #gift-guide-{{ section.id }} .gg-heading--mobile { display:none !important; }
      #gift-guide-{{ section.id }} .gg-subtext--mobile { display:none !important; }
      #gift-guide-{{ section.id }} .gg-heading { display:block; }
      #gift-guide-{{ section.id }} .gg-subtext { display:block; }
    }

    /* Mobile / tablet */
    @media (max-width: 989px) {
      #gift-guide-{{ section.id }} .hb-hamburger { display:inline-flex; align-items:center; justify-content:center; background:transparent; border:0; }
      #gift-guide-{{ section.id }} .hb-right { display:none; } /* desktop button hidden on small screens */
      #gift-guide-{{ section.id }} .hb-logo-wrap { align-items:flex-start; justify-content:center; }
      /* logo left on mobile */
      #gift-guide-{{ section.id }} .hb-logo { text-align:left; width:100%; margin-left:6px; }
      /* tagline centered as requested */
      #gift-guide-{{ section.id }} .hb-tagline { display:block; text-align:center; }

      /* show mobile heading/subtext and hide desktop ones */
      #gift-guide-{{ section.id }} .gg-heading--mobile { display:block; text-align:center; }
      #gift-guide-{{ section.id }} .gg-subtext--mobile { display:block; text-align:center; }
      #gift-guide-{{ section.id }} .gg-heading { display:none; }
      #gift-guide-{{ section.id }} .gg-subtext { display:none; }

      #gift-guide-{{ section.id }} .gg-content { padding: 16px; text-align:center; position: static; }
      #gift-guide-{{ section.id }} .gg-hero__media { height:420px; }
      #gift-guide-{{ section.id }} .gg-cta { display:none; } /* desktop CTA hidden on mobile */
      #gift-guide-{{ section.id }} .gg-cta--mobile { display:inline-flex; }
    }
  {%- endstyle -%}

  <!-- HEADER -->
  <div class="hb">
    <div class="hb-inner">
      <!-- Mobile hamburger -->
      <button class="hb-hamburger" id="hbHamburger-{{ section.id }}" aria-controls="hbMobileMenu-{{ section.id }}" aria-expanded="false" aria-label="Open menu" type="button">
        <span id="hbHamburgerIcon-{{ section.id }}">☰</span>
      </button>

      <!-- Logo + optional tagline (tagline hidden on mobile in header; visible in menu) -->
      <div class="hb-logo-wrap" role="banner">
        <h1 class="hb-logo">{{ section.settings.logo_text }}</h1>
        <div class="hb-tagline">{{ section.settings.tagline_text }}</div>
      </div>

      <!-- Right choose button (desktop) -->
      <div class="hb-right">
        {%- if section.settings.choose_btn_label != blank -%}
          <a class="hb-choose" href="{{ section.settings.choose_btn_link }}" aria-label="{{ section.settings.choose_btn_label }}">
            <span>{{ section.settings.choose_btn_label }}</span>
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"><path d="M6 12h12m0 0-5-5m5 5-5 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </a>
        {%- endif -%}
      </div>
    </div>

    <!-- Mobile menu -->
    <div class="hb-mobile-menu" id="hbMobileMenu-{{ section.id }}" aria-hidden="true">
      <div class="hb-tagline">{{ section.settings.tagline_text }}</div>
      {%- if section.settings.choose_btn_label != blank -%}
        <a class="hb-choose" href="{{ section.settings.choose_btn_link }}" aria-label="{{ section.settings.choose_btn_label }}">
          <span>{{ section.settings.choose_btn_label }}</span>
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"><path d="M6 12h12m0 0-5-5m5 5-5 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </a>
      {%- endif -%}
    </div>
  </div>

  <!-- Optional announcement bar (kept for backward compatibility) -->
  <div class="gg-announcement" {% if section.settings.hide_announcement %}style="display:none"{% endif %}>
    <div class="gg-announcement__inner">
      <div class="gg-announcement__text">{{ section.settings.announcement_text }}</div>
      {%- if section.settings.choose_btn_label != blank -%}
        <!-- duplicate choose button small (kept for fallback) -->
        <a class="gg-choose" href="{{ section.settings.choose_btn_link }}" aria-label="{{ section.settings.choose_btn_label }}">
          <span>{{ section.settings.choose_btn_label }}</span>
          <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M6 12h12m0 0-5-5m5 5-5 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </a>
      {%- endif -%}
    </div>
  </div>

  <!-- HERO WRAP -->
  <div class="gg-wrap">
    <div class="gg-content">
      <!-- Desktop heading/subtext -->
      <h2 class="gg-heading">{{ section.settings.heading }}</h2>
      <div class="gg-subtext">{{ section.settings.subtext }}</div>

      <!-- Mobile heading/subtext (editable separately) -->
      <h2 class="gg-heading--mobile">{{ section.settings.mobile_heading }}</h2>
      <div class="gg-subtext--mobile">{{ section.settings.mobile_subtext }}</div>

      {%- if section.settings.cta_label != blank -%}
        <a class="gg-cta" href="{{ section.settings.cta_link }}">
          <span>{{ section.settings.cta_label }}</span>
          <svg class="gg-arrow" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"><path d="M6 12h12m0 0-5-5m5 5-5 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </a>
      {%- endif -%}
    </div>

    <div class="gg-hero">
      <div class="gg-hero__frame">
        <div class="gg-hero__media">
          {% if section.settings.bg_image != blank %}
            {%- render 'image', image: section.settings.bg_image, widths: '750,1100,1500,2000', sizes: '100vw', alt: section.settings.bg_image.alt | escape -%}
          {% else %}
            <img src="{{ 'placeholder-image.png' | asset_url }}" alt="" loading="lazy">
          {% endif %}
          {%- if section.settings.cta_label != blank -%}
            <a class="gg-cta gg-cta--mobile" href="{{ section.settings.cta_link }}">
              <span>{{ section.settings.cta_label }}</span>
              <svg class="gg-arrow" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"><path d="M6 12h12m0 0-5-5m5 5-5 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
            </a>
          {%- endif -%}
        </div>
      </div>
    </div>
  </div>

  <div class="gg-strip">
    <div class="gg-strip__inner">{{ section.settings.bottom_strip_text }}</div>
  </div>

  {%- javascript -%}
    (function() {
      // Ensure elements are present before attaching listeners (fixes hamburger not working in some theme injections)
      function initGiftHeader() {
        var hamburger = document.getElementById('hbHamburger-{{ section.id }}');
        var icon = document.getElementById('hbHamburgerIcon-{{ section.id }}');
        var menu = document.getElementById('hbMobileMenu-{{ section.id }}');

        if (!hamburger || !menu) return;

        function openMenu() {
          menu.classList.add('open');
          hamburger.classList.add('is-open');
          hamburger.setAttribute('aria-expanded','true');
          menu.setAttribute('aria-hidden','false');
          if (icon) icon.textContent = '✕';
        }
        function closeMenu() {
          menu.classList.remove('open');
          hamburger.classList.remove('is-open');
          hamburger.setAttribute('aria-expanded','false');
          menu.setAttribute('aria-hidden','true');
          if (icon) icon.textContent = '☰';
        }

        hamburger.addEventListener('click', function(e) {
          e.preventDefault();
          if (menu.classList.contains('open')) closeMenu(); else openMenu();
        });

        // close on resize to desktop
        window.addEventListener('resize', function() {
          if (window.innerWidth >= 990 && menu.classList.contains('open')) {
            closeMenu();
          }
        });

        // close when choose link clicked (mobile)
        var chooseMobile = menu.querySelector('.hb-choose');
        if (chooseMobile) chooseMobile.addEventListener('click', closeMenu);
      }

      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initGiftHeader);
      } else {
        initGiftHeader();
      }
    })();
  {%- endjavascript -%}

  {%- schema -%}
  {
    "name": "Gift Guide Banner",
    "settings": [
      { "type": "text", "id": "logo_text", "label": "Logo text", "default": "TISSO VISION" },
      { "type": "text", "id": "tagline_text", "label": "Header tagline", "default": "Find the ideal gift for your loved ones." },
      { "type": "url", "id": "choose_btn_link", "label": "Choose Gift Button Link", "default": "/" },

      { "type": "text", "id": "choose_btn_label", "label": "Choose button label", "default": "CHOOSE GIFT" },
      { "type": "color", "id": "choose_btn_bg", "label": "Choose button color (yellow)", "default": "#FFE34D" },
      { "type": "color", "id": "header_bg", "label": "Header background color", "default": "#ffffff" },
      { "type": "color", "id": "text_color", "label": "Header / section text color", "default": "#111111" },

      { "type": "header", "content": "Announcement (optional)" },
      { "type": "checkbox", "id": "hide_announcement", "label": "Hide announcement bar", "default": true },
      { "type": "text", "id": "announcement_text", "label": "Announcement text", "default": "Find the ideal gift for your loved ones." },
      { "type": "color", "id": "announcement_bg", "label": "Announcement background", "default": "#efefef" },

      { "type": "header", "content": "Hero" },
      { "type": "image_picker", "id": "bg_image", "label": "Background illustration (desktop & mobile)" },
      { "type": "text", "id": "heading", "label": "Hero heading (desktop)", "default": "The Gift Guide" },
      { "type": "richtext", "id": "subtext", "label": "Hero subtext (desktop)", "default": "<p>Discover Joy: Your Ultimate Holiday Gift Destination.</p>" },

      /* Mobile-specific editable title/description */
      { "type": "text", "id": "mobile_heading", "label": "Hero heading (mobile)", "default": "Gift Box" },
      { "type": "text", "id": "mobile_subtext", "label": "Hero subtext (mobile)", "default": "Find the ideal gift for your loved ones." },

      { "type": "text", "id": "cta_label", "label": "Hero CTA label", "default": "SHOP NOW" },
      { "type": "url", "id": "cta_link", "label": "Hero CTA link", "default": "/" },

      { "type": "header", "content": "Bottom strip" },
      { "type": "text", "id": "bottom_strip_text", "label": "Bottom strip text", "default": "SUSTAINABLE, ETHICALLY MADE CLOTHES IN SIZES XXS TO 6XL" },

      { "type": "color", "id": "section_bg", "label": "Section background", "default": "#ffffff" }
    ],
    "blocks": [],
    "presets": [ { "name": "Gift Guide Banner" } ]
  }
  {%- endschema -%}
</section>
